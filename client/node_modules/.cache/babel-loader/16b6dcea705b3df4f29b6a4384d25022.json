{"ast":null,"code":"var _jsxFileName = \"/Users/oferraanan/Downloads/shopping/client/src/admin/components/ProductAdd.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect, useReducer, useCallback } from 'react'; // MUI\n\nimport { Box, Grid, Button, Alert } from '@mui/material'; // COMPONENTS\n\nimport Input from './Input';\nimport Selector from './Selector'; // CammelCase Helper\n\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\n\nconst camelCase = str => {\n  return str.charAt(0).toUpperCase() + str.slice(1).toLowerCase();\n}; //REDUCER\n\n\nconst FORM_UPDATE = 'FORM_UPDATE';\n\nconst formReducer = (state, action) => {\n  if (action.type === FORM_UPDATE) {\n    let formState = state;\n    let id = action.id;\n    let value = action.value;\n\n    if (id.toString().includes('filter')) {\n      // the filter Type\n      let type = id.toString().replace('filter', ''); // remove existing filter of the same Type\n\n      let filters = formState['filters'].filter(item => item.filterType !== type); // add this new filter to the Filters Array\n\n      filters.push({\n        filterType: type,\n        filterVariant: value\n      }); // set to the formState\n\n      formState['filters'] = filters;\n      console.log(filters);\n    } else {\n      formState[id] = value;\n    }\n\n    switch (id) {\n      case 'productCost':\n      case 'productInventory':\n        if (!value || value === '') {\n          formState[id] = id === 'productInventory' ? 1 : 0;\n        }\n\n        break;\n\n      default:\n        break;\n    } // CHECK IF THE FROM IS VALID\n\n\n    let formIsValid = Object.keys(formState).reduce((prev, key) => {\n      let res;\n\n      if (key === 'productCost' || key === 'productInventory') {\n        res = formState[key] > 0;\n      } else {\n        res = formState[key] !== '';\n      }\n\n      return res && prev;\n    }, true);\n\n    if (action.editedProduct) {\n      if (key === 'filters') {\n        // compare editedProduct filters with formState\n        // only when are different, set for FormIsValid\n        let filterRes = false;\n        const filters = action.editedProduct[key];\n        formState[key].map(filter => {\n          const type = filter.filterType;\n          const variant = filters.find(filter => filter.filterType === type);\n          filterRes = filterRes && variant ? variant.filterVariant !== filter.filterVariant : true;\n        }); // console.log(res, filterRes, res && filterRes);\n\n        res = res && filterRes;\n      } else if (key !== 'formIsValid') {\n        // editedProduct does not have this property.\n        res = res ? res : formState[key] !== action.editedProduct[key];\n        console.log('res', key, res);\n      }\n    }\n\n    return { ...formState,\n      formIsValid: formIsValid\n    };\n  }\n\n  return state;\n}; // COMPONENT\n\n\nconst ProductAdd = props => {\n  _s();\n\n  const {\n    filters,\n    onCreateProduct,\n    onEditProduct,\n    editedProduct,\n    alert\n  } = props; //REDUCER ACTION / UPDATE\n\n  const [formState, dispatchFormState] = useReducer(formReducer, {\n    productName: editedProduct ? editedProduct.productName : '',\n    productDesc: editedProduct ? editedProduct.productDesc : '',\n    productCost: editedProduct ? editedProduct.productCost : 0,\n    productInventory: editedProduct ? editedProduct.productInventory : 1,\n    productStatus: editedProduct ? editedProduct.productStatus : 'active',\n    filters: editedProduct ? editedProduct.filters : [],\n    formIsValid: false\n  }); // ALERT HANDLER\n\n  const [showAlert, setShowAlert] = useState(null);\n  useEffect(() => {\n    setShowAlert(alert);\n  }, [alert]); //UPADTE INPUTS\n\n  const onInputUpdate = useCallback((id, value) => {\n    dispatchFormState({\n      type: FORM_UPDATE,\n      id,\n      value,\n      editedProduct\n    });\n    setShowAlert(null);\n  }, [dispatchFormState, setShowAlert]); //INPUTS CALLBACK\n\n  const onInputChange = event => {\n    let id = event.target.id;\n    let value = event.target.value;\n    id && onInputUpdate(id, value);\n  }; // SUBMIT HANDLER\n\n\n  const onSubmitClicked = () => {\n    // if -> just in case...\n    // it is validated in the renderer scope\n    if (formState.formIsValid && onCreateProduct) {\n      let product = formState;\n      delete product.formIsValid; // parent callback\n\n      onCreateProduct && onCreateProduct(product);\n      onEditProduct && onEditProduct(product);\n    }\n  };\n\n  return /*#__PURE__*/_jsxDEV(Box, {\n    sx: {\n      flexGrow: 1,\n      padding: '50px 0'\n    },\n    display: 'flex',\n    justifyContent: 'center',\n    children: /*#__PURE__*/_jsxDEV(Grid, {\n      container: true,\n      sx: {\n        width: 1 / 2\n      },\n      flexDirection: 'column',\n      justifyContent: 'flex-start',\n      alignItems: 'center',\n      children: [/*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        sx: {\n          width: 1\n        },\n        children: \"Create new Product\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        display: 'flex',\n        flexDirection: 'column',\n        justifyContent: 'space-between',\n        alignItems: 'center',\n        sx: {\n          width: 1\n        },\n        children: [/*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          sx: {\n            width: 1\n          },\n          padding: 2,\n          children: /*#__PURE__*/_jsxDEV(Input, {\n            inputType: 'text',\n            id: 'productName',\n            defaultValue: formState.productName,\n            label: \"Product Name\",\n            onChange: onInputChange,\n            required: true,\n            camelCased: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 187,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 186,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          sx: {\n            width: 1\n          },\n          padding: 2,\n          children: /*#__PURE__*/_jsxDEV(Input, {\n            inputType: 'text',\n            id: 'productDesc',\n            defaultValue: formState.productDesc,\n            label: \"Product Description\",\n            onChange: onInputChange,\n            required: true,\n            camelCased: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 198,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 197,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          sx: {\n            width: 1\n          },\n          children: \"Product Filters\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 208,\n          columnNumber: 11\n        }, this), filters.filterTypes.map((type, index) => {\n          var _formState$filters$fi;\n\n          const variants = filters.filterList.filter(item => item.type === type).map(item => item.variant);\n          return /*#__PURE__*/_jsxDEV(Grid, {\n            item: true,\n            sx: {\n              width: 1\n            },\n            padding: 2,\n            children: /*#__PURE__*/_jsxDEV(Selector, {\n              id: `filter${camelCase(type)}`,\n              selectors: variants,\n              defaultValue: (_formState$filters$fi = formState.filters.find(filter => filter.filterType === `${camelCase(type)}`)) === null || _formState$filters$fi === void 0 ? void 0 : _formState$filters$fi.filterVariant,\n              label: `${camelCase(type)}`,\n              onSelect: onInputChange,\n              required: true\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 218,\n              columnNumber: 17\n            }, this)\n          }, index, false, {\n            fileName: _jsxFileName,\n            lineNumber: 217,\n            columnNumber: 15\n          }, this);\n        }), /*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          sx: {\n            width: 1,\n            color: 'primary'\n          },\n          children: \"Product Inventory\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 233,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          sx: {\n            width: 1\n          },\n          padding: 2,\n          children: /*#__PURE__*/_jsxDEV(Input, {\n            inputType: 'currency',\n            id: 'productCost',\n            defaultValue: formState.productCost,\n            label: \"Product Cost\",\n            onChange: onInputChange,\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 237,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 236,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          sx: {\n            width: 1\n          },\n          padding: 2,\n          children: /*#__PURE__*/_jsxDEV(Input, {\n            inputType: 'number',\n            id: 'productInventory',\n            defaultValue: formState.productInventory,\n            label: \"Product Inventory\",\n            defaultValue: '1',\n            onChange: onInputChange,\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 247,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 246,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          sx: {\n            width: 1\n          },\n          padding: 2,\n          children: /*#__PURE__*/_jsxDEV(Selector, {\n            id: 'productStatus',\n            selectors: ['Inactive', 'Active'],\n            defaultIndex: 1,\n            label: 'Product Status',\n            onSelect: onInputChange,\n            required: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 258,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 257,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Grid, {\n          item: true,\n          sx: {\n            width: 1\n          },\n          padding: 2,\n          children: /*#__PURE__*/_jsxDEV(Button, {\n            sx: {\n              width: 1\n            },\n            variant: \"contained\",\n            color: \"success\",\n            onClick: onSubmitClicked,\n            disabled: !formState.formIsValid,\n            children: \"Submit\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 268,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 267,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 178,\n        columnNumber: 9\n      }, this), showAlert && formState.formIsValid && /*#__PURE__*/_jsxDEV(Grid, {\n        item: true,\n        sx: {\n          width: 1\n        },\n        children: /*#__PURE__*/_jsxDEV(Alert, {\n          severity: showAlert.type,\n          color: showAlert.type,\n          children: showAlert.message\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 281,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 280,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 163,\n    columnNumber: 5\n  }, this);\n};\n\n_s(ProductAdd, \"bfUDElpjYqRzDMKyp41z7wUN5sY=\");\n\n_c = ProductAdd;\nexport default ProductAdd;\n\nvar _c;\n\n$RefreshReg$(_c, \"ProductAdd\");","map":{"version":3,"sources":["/Users/oferraanan/Downloads/shopping/client/src/admin/components/ProductAdd.js"],"names":["React","useState","useEffect","useReducer","useCallback","Box","Grid","Button","Alert","Input","Selector","camelCase","str","charAt","toUpperCase","slice","toLowerCase","FORM_UPDATE","formReducer","state","action","type","formState","id","value","toString","includes","replace","filters","filter","item","filterType","push","filterVariant","console","log","formIsValid","Object","keys","reduce","prev","key","res","editedProduct","filterRes","map","variant","find","ProductAdd","props","onCreateProduct","onEditProduct","alert","dispatchFormState","productName","productDesc","productCost","productInventory","productStatus","showAlert","setShowAlert","onInputUpdate","onInputChange","event","target","onSubmitClicked","product","flexGrow","padding","width","filterTypes","index","variants","filterList","color","message"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useReducer, useCallback } from 'react';\n\n// MUI\nimport { Box, Grid, Button, Alert } from '@mui/material';\n\n// COMPONENTS\nimport Input from './Input';\nimport Selector from './Selector';\n\n// CammelCase Helper\nconst camelCase = (str) => {\n  return str.charAt(0).toUpperCase() + str.slice(1).toLowerCase();\n};\n\n//REDUCER\nconst FORM_UPDATE = 'FORM_UPDATE';\nconst formReducer = (state, action) => {\n  if (action.type === FORM_UPDATE) {\n    let formState = state;\n\n    let id = action.id;\n    let value = action.value;\n\n    if (id.toString().includes('filter')) {\n      // the filter Type\n      let type = id.toString().replace('filter', '');\n\n      // remove existing filter of the same Type\n      let filters = formState['filters'].filter(\n        (item) => item.filterType !== type\n      );\n\n      // add this new filter to the Filters Array\n      filters.push({\n        filterType: type,\n        filterVariant: value,\n      });\n\n      // set to the formState\n      formState['filters'] = filters;\n      console.log(filters);\n    } else {\n      formState[id] = value;\n    }\n\n    switch (id) {\n      case 'productCost':\n      case 'productInventory':\n        if (!value || value === '') {\n          formState[id] = id === 'productInventory' ? 1 : 0;\n        }\n        break;\n      default:\n        break;\n    }\n\n    // CHECK IF THE FROM IS VALID\n    let formIsValid = Object.keys(formState).reduce((prev, key) => {\n      let res;\n      if (key === 'productCost' || key === 'productInventory') {\n        res = formState[key] > 0;\n      } else {\n        res = formState[key] !== '';\n      }\n\n      return res && prev;\n    }, true);\n\n    if (action.editedProduct) {\n      if (key === 'filters') {\n        // compare editedProduct filters with formState\n        // only when are different, set for FormIsValid\n        let filterRes = false;\n        const filters = action.editedProduct[key];\n        formState[key].map((filter) => {\n          const type = filter.filterType;\n          const variant = filters.find((filter) => filter.filterType === type);\n\n          filterRes =\n            filterRes && variant\n              ? variant.filterVariant !== filter.filterVariant\n              : true;\n        });\n\n        // console.log(res, filterRes, res && filterRes);\n        res = res && filterRes;\n      } else if (key !== 'formIsValid') {\n        // editedProduct does not have this property.\n\n        res = res ? res : formState[key] !== action.editedProduct[key];\n        console.log('res', key, res);\n      }\n    }\n\n    return {\n      ...formState,\n      formIsValid: formIsValid,\n    };\n  }\n\n  return state;\n};\n\n// COMPONENT\nconst ProductAdd = (props) => {\n  const { filters, onCreateProduct, onEditProduct, editedProduct, alert } =\n    props;\n\n  //REDUCER ACTION / UPDATE\n  const [formState, dispatchFormState] = useReducer(formReducer, {\n    productName: editedProduct ? editedProduct.productName : '',\n    productDesc: editedProduct ? editedProduct.productDesc : '',\n    productCost: editedProduct ? editedProduct.productCost : 0,\n    productInventory: editedProduct ? editedProduct.productInventory : 1,\n    productStatus: editedProduct ? editedProduct.productStatus : 'active',\n    filters: editedProduct ? editedProduct.filters : [],\n    formIsValid: false,\n  });\n\n  // ALERT HANDLER\n  const [showAlert, setShowAlert] = useState(null);\n  useEffect(() => {\n    setShowAlert(alert);\n  }, [alert]);\n\n  //UPADTE INPUTS\n  const onInputUpdate = useCallback(\n    (id, value) => {\n      dispatchFormState({\n        type: FORM_UPDATE,\n        id,\n        value,\n        editedProduct,\n      });\n      setShowAlert(null);\n    },\n    [dispatchFormState, setShowAlert]\n  );\n\n  //INPUTS CALLBACK\n  const onInputChange = (event) => {\n    let id = event.target.id;\n    let value = event.target.value;\n\n    id && onInputUpdate(id, value);\n  };\n\n  // SUBMIT HANDLER\n  const onSubmitClicked = () => {\n    // if -> just in case...\n    // it is validated in the renderer scope\n    if (formState.formIsValid && onCreateProduct) {\n      let product = formState;\n      delete product.formIsValid;\n\n      // parent callback\n      onCreateProduct && onCreateProduct(product);\n      onEditProduct && onEditProduct(product);\n    }\n  };\n\n  return (\n    <Box\n      sx={{ flexGrow: 1, padding: '50px 0' }}\n      display={'flex'}\n      justifyContent={'center'}\n    >\n      <Grid\n        container\n        sx={{ width: 1 / 2 }}\n        flexDirection={'column'}\n        justifyContent={'flex-start'}\n        alignItems={'center'}\n      >\n        <Grid item sx={{ width: 1 }}>\n          Create new Product\n        </Grid>\n        <Grid\n          item\n          display={'flex'}\n          flexDirection={'column'}\n          justifyContent={'space-between'}\n          alignItems={'center'}\n          sx={{ width: 1 }}\n        >\n          <Grid item sx={{ width: 1 }} padding={2}>\n            <Input\n              inputType={'text'}\n              id={'productName'}\n              defaultValue={formState.productName}\n              label=\"Product Name\"\n              onChange={onInputChange}\n              required\n              camelCased\n            />\n          </Grid>\n          <Grid item sx={{ width: 1 }} padding={2}>\n            <Input\n              inputType={'text'}\n              id={'productDesc'}\n              defaultValue={formState.productDesc}\n              label=\"Product Description\"\n              onChange={onInputChange}\n              required\n              camelCased\n            />\n          </Grid>\n          <Grid item sx={{ width: 1 }}>\n            Product Filters\n          </Grid>\n          {filters.filterTypes.map((type, index) => {\n            const variants = filters.filterList\n              .filter((item) => item.type === type)\n              .map((item) => item.variant);\n\n            return (\n              <Grid key={index} item sx={{ width: 1 }} padding={2}>\n                <Selector\n                  id={`filter${camelCase(type)}`}\n                  selectors={variants}\n                  defaultValue={\n                    formState.filters.find(\n                      (filter) => filter.filterType === `${camelCase(type)}`\n                    )?.filterVariant\n                  }\n                  label={`${camelCase(type)}`}\n                  onSelect={onInputChange}\n                  required\n                />\n              </Grid>\n            );\n          })}\n          <Grid item sx={{ width: 1, color: 'primary' }}>\n            Product Inventory\n          </Grid>\n          <Grid item sx={{ width: 1 }} padding={2}>\n            <Input\n              inputType={'currency'}\n              id={'productCost'}\n              defaultValue={formState.productCost}\n              label=\"Product Cost\"\n              onChange={onInputChange}\n              required\n            />\n          </Grid>\n          <Grid item sx={{ width: 1 }} padding={2}>\n            <Input\n              inputType={'number'}\n              id={'productInventory'}\n              defaultValue={formState.productInventory}\n              label=\"Product Inventory\"\n              defaultValue={'1'}\n              onChange={onInputChange}\n              required\n            />\n          </Grid>\n          <Grid item sx={{ width: 1 }} padding={2}>\n            <Selector\n              id={'productStatus'}\n              selectors={['Inactive', 'Active']}\n              defaultIndex={1}\n              label={'Product Status'}\n              onSelect={onInputChange}\n              required\n            />\n          </Grid>\n          <Grid item sx={{ width: 1 }} padding={2}>\n            <Button\n              sx={{ width: 1 }}\n              variant=\"contained\"\n              color=\"success\"\n              onClick={onSubmitClicked}\n              disabled={!formState.formIsValid}\n            >\n              Submit\n            </Button>\n          </Grid>\n        </Grid>\n        {showAlert && formState.formIsValid && (\n          <Grid item sx={{ width: 1 }}>\n            <Alert severity={showAlert.type} color={showAlert.type}>\n              {showAlert.message}\n            </Alert>\n          </Grid>\n        )}\n      </Grid>\n    </Box>\n  );\n};\n\nexport default ProductAdd;\n"]},"metadata":{},"sourceType":"module"}